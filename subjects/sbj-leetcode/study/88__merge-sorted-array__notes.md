TODO:
- try to solve it without external memory
